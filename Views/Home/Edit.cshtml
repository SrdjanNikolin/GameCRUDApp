@model HomeEditViewModel


@{
ViewBag.Title = Model.PageTitle;
}

<div class="row">
    <div class="card text-center col-md-4 col-lg-3 bg-light m-1">
        <img src="@(Model.Game.GameImage == null ? Href("~/images/notFound404.png") : Model.Game.GameImage.GameImageData)" />
        <div class="card-body">
            <h4 class="card-title">@Model.Game.Name</h4>
            <h5>@Model.Game.Price $$</h5>
            <p class="card-text">Some text for specific game. Some text for specific game. Some text for specific game.</p>
            <a asp-controller="Home" asp-action="Index" class="btn btn-primary">Back</a>
            <a href="#" class="btn btn-primary w-100">Delete</a>
        </div>
    </div>

    <form method="post" asp-controller="Home" asp-action="Edit" asp-route-id="@Model.Game.GameId" asp-route-gameImageId="@(Model.Game.GameImage == null ? null : Model.Game.GameImage.GameImageId)" enctype="multipart/form-data" id="editForm">
        <div class="form-group">
            <label asp-for="UpdateGameViewModel.Name"></label>
            <input type="text" asp-for="UpdateGameViewModel.Name" class="form-control" placeholder="Name of game">
            <span asp-validation-for="UpdateGameViewModel.Name" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label asp-for="UpdateGameViewModel.Price"></label>
            <input type="number" asp-for="UpdateGameViewModel.Price" step="0,01" class="form-control" placeholder="Price of game">
            <span asp-validation-for="UpdateGameViewModel.Price" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label asp-for="UpdateGameViewModel.Genre"></label>
            <select class="form-control" asp-for="UpdateGameViewModel.Genre">
                <option disabled selected>Select genre</option>
                @foreach (string genre in Enum.GetNames(typeof(Genre)))
                {
                    <option value="@genre">@genre</option>
                }
            </select>
        </div>
        <div class="form-group">
            <label asp-for="UpdateGameViewModel.GameImage"><i><b>Input for the game image. Note that the image is optional and can be added or updated at a later point.</b></i></label>
            <input asp-for="UpdateGameViewModel.GameImage" class="form-control-file" style="width:220px">
        </div>
        <button class="btn btn-primary">Update</button>
        @if (Model.SuccessList != null)
        {
            foreach (var message in Model.SuccessList)
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <strong>Success!</strong> @message
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }
        }
        @if (Model.ErrorList != null)
        {
            foreach (var message in Model.ErrorList)
            {
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    <strong>Error!</strong> @message
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }
        }
    </form>
</div>
@section Scripts { 
    <script>
        $("#editForm").submit(function (event) {
            var inputsAreEmpty = true;
            var formData = $('#editForm').serializeArray();
            var gameImageData = document.getElementById('UpdateGameViewModel_GameImage').value;
            for (var index = 0; index < formData.length - 1; index++) {
                if (formData[index].value != "") {
                    inputsAreEmpty = false;
                    break;
                }
            }
            if (inputsAreEmpty == true && gameImageData == "") {
                //alert should be prettier
                //make it fade out
                alert("No values entered.");
                event.preventDefault();
            }
        });
    </script>
} 